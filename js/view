{
    "views":{
        "account_balance":{
                    "map":"function(doc, meta) { if (meta.id.substring(0,5) != \"_sync\" && doc.type == \"trading_name_journal\" && doc.from && doc.to && typeof doc.amount != \"undefined\" && parseFloat(doc.amount) >= 0 && doc.currency && doc.timestamp) { if (typeof doc.verified != \"undefined\" && doc.verified === true) { emit( \"trading_name,\" + doc.from + \",\" + doc.currency, -doc.amount ); emit( \"trading_name,\" + doc.to + \",\" + doc.currency, doc.amount ); } } }"
        },
        "account_details":{
            "map":"function(doc, meta) {
                    function clone(obj) {
                        if (null == obj || \"object\" != typeof obj) return obj;
                        var copy = obj.constructor();
                        for (var attr in obj) {
                            if (obj.hasOwnProperty(attr)) copy[attr] = obj[attr];
                        }
                        return copy;
                    }
                    if (meta.id.substring(0,5) != \"_sync\" && doc.type == \"trading_name_journal\" && doc.from && doc.to && typeof doc.amount != \"undefined\" && parseFloat(doc.amount) >= 0 && doc.currency && doc.timestamp) {
                        doc.isPositive = true;
                        doc.subject = doc.from + \" \" + doc.currency;
                        delete(doc._sync);
                        emit( \"trading_name,\" + doc.to + \",\" + doc.currency, doc );
                        from = clone(doc);
                        from.isPositive = false;
                        from.subject = from.to + \" \" + from.currency;
                        from.amount = -from.amount;
                        emit( \"trading_name,\" + from.from + \",\" + from.currency, from );
                    }
            }"
        },
        "accounts":{
            "map":"function(doc,meta) {
                if (meta.id.substring(0,5) != \"_sync\" && doc.type == \"trading_name\" && doc.name && doc.currency && doc.steward) {
                    emit( {
                        trading_name : doc.name, currency : doc.currency, steward : doc.steward
                    }, \"trading_name,\" + doc.name.toLowerCase() + \",\" + doc.currency.toLowerCase() );
                }
            }"
        },
        "bematag":{
            "map":
                "function(doc, meta) {
                    if(meta.id.substring(0,5) != \"_sync\" && doc.type == \"beamtag\" && (doc._deleted == undefined || doc._deleted != true)) {
                        if(typeof doc.archived == \"undefined\" || doc.archived === false ) {
                            emit(doc.hashTag, doc.trading_names);
                        }
                    }
                }"
        }
    }
}